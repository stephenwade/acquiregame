<link rel="import" href="../polymer/polymer.html">

<dom-module id="acquire-player-page">
  <style>
    html, body, :host, canvas {
      display: block;
      
      width: 100%;
      height: 100%;
      padding: 0;
      margin: 0;
      
      overflow: hidden;
      font-size: 0;
    }
  </style>

  <template>
    <canvas id="canvas">
      Say “Hello!” to the year 2000 for me!
    </canvas>
  </template>
  
  <script src="./view.js"></script>
  
  <script>
    'use strict';
    
    Polymer({
      is: 'acquire-player-page',
      
      created() {
        this.hand = [];
      },
      
      attached() {
        if (! this.view) {
          this.view = new PlayerView(this.$.canvas);
        }
        this.view.attach();
        this.view.resize();
        
        var self = this;
        
        socket.on('new tiles', (msg) => {
          self.view.addTiles(msg);
          self.hand += msg;
          console.log('new tiles!', self.hand);
        });
        
        this.resizeHandler = () => this.view.resize();
        window.addEventListener('resize', this.resizeHandler);
        this.canvasClickHandler = (event) => this.view.findClickSubject(event)
        this.$.canvas.addEventListener('click', this.canvasClickHandler );
      },
      
      detached() {
        this.view.detatch();
        window.removeEventListener('resize', this.resizeHandler);
        this.$.canvas.removeEventListener('click', this.canvasClickHandler);
      }
    });
  </script>

</dom-module>
